$fn = 100;

//use a cone shape for inside as a support structure
use_support = false;
//print holes
print_holes = true;
//print handle
print_handle = true;


// height
h = 55;
// radius
r = 60/2;
//fillet
f = 15;
//strength
s = 1;

//hole radius
hr = 1.2;
//hole distance
hd = 4;
//handle length
hl = 100;
//handle radius - (r-f) for handle to match shaker
hra = (r-f);

//h = 100;
//r = 50/2;
//f = 5;
//s = 2;


module shaker(h,r,f) {
    cylinder(f,r-f,r);
    translate([0,0,f])cylinder(h-2*f,r,r);
    translate([0,0,h-f])cylinder(f,r,r-f);
}

module shaker_support(h,r,f) {
    cylinder(f,r-f,r);
    translate([0,0,f])cylinder(h-r-f,r,r);
    translate([0,0,h-r])cylinder(r,r,0);
}



difference() {
    shaker(h,r,f);
    translate([0,0,s]) if(use_support) {shaker_support(h-2*s,r-s,f);} else {shaker(h-2*s,r-s,f);}
    
if(print_holes) {
    // top and bottom holes
    radi = (r-f)/2;
    nh = floor(2*3.1415*radi / (hr*2+hd)); //number of holes
    for(i = [0:nh-1]) {
        rotate([0,0,i*(360/nh)]) translate([radi,0,0]) cylinder(h,hr,hr,$fn=20);
    }
    
    // side holes
    nhs = floor((2*3.1415*r) / (hr*2+hd)); //number of holes
    for(i = [0:nhs-1]) {
        translate([0,0,h/2])rotate([90,0,i*(360/nhs)]) cylinder(r,hr,hr,$fn=20);
    }

    // fillet holes
    radi_f = r-(f/2);
    nhf = floor((2*3.1415*radi_f) / (hr*2+hd)); //number of holes
    // top fillet holes
    for(i = [0:nhf-1]) {
        ang = i*(360/nhf);
        translate([cos(ang)*(r-f),sin(ang)*(r-f),h-f]) rotate([0,45,ang]) cylinder(r,hr,hr,$fn=20);
    }
    // bottom fillet holes
    for(i = [0:nhf-1]) {
        ang = i*(360/nhf);
        translate([cos(ang)*(r-f),sin(ang)*(r-f),f]) rotate([0,135,ang]) cylinder(r,hr,hr,$fn=20);
    }


}

    
    
}




if(print_handle) {
translate([0,0,h-s])scale([hra/10,hra/10,hl/50])rotate_extrude()polygon([[-9.50263537704416,3.942314668138618],[-9.185291592263187,4.963708937599927],[-8.904639113998025,5.817165504348857],[-8.58754726935631,6.626099002671237],[-8.220152089278505,7.3723091842362125],[-7.838892940141158,8.100319117470336],[-7.448391144964119,8.805578740290892],[-7.062510672806926,9.506288301028736],[-6.699736815748967,10.216097985932004],[-6.355448250770393,10.939557857083415],[-6.075858208069671,11.724443566351455],[-5.842481395567416,12.557104927487986],[-5.683045751382707,13.471667406113355],[-5.551338045317076,14.420355350359074],[-5.500503492098762,15.448669381052275],[-5.502814153608684,16.522484032572606],[-5.5836873064559995,17.653174460126856],[-5.689977735912471,18.79524004288789],[-5.8655880106666425,19.93730562564892],[-6.085100854109357,21.06799605320317],[-6.367001558320002,22.16456101513707],[-6.667387554610034,23.238375666657404],[-7.000122812038993,24.282614914640103],[-7.34672203852749,25.32002906949873],[-7.702563911055681,26.366543348522782],[-8.053784460564025,27.428982844836334],[-8.372655748933441,28.54602308614244],[-8.66379909918378,29.70173885515161],[-8.904107896215805,30.918880462277414],[-9.121310078148596,32.15877237981678],[-9.273813737803534,33.457815104431425],[-9.384725490279852,34.79325832570777],[-9.435560043498166,36.17875222989396],[-9.467909304637093,37.57789632032829],[-9.435560043498166,38.95884016243178],[-9.356997552160774,40.30793356995626],[-9.204493892505834,41.57967592207462],[-9.024262294731816,42.80591765336585],[-8.749293575050944,43.89565752217569],[-8.407315671582294,44.89439614933126],[-7.959047338657171,45.75663291400542],[-7.471497760063351,46.57336905785245],[-6.891521721072599,47.26042843234216],[-6.25840046735361,47.86331165830167],[-5.558270029846845,48.34334320802791],[-4.84427562328054,48.7846992300511],[-4.116450068849936,49.12350133023381],[-3.388657335614572,49.39842503627909],[-2.654943779156217,49.64313822691076],[-1.976163854001145,49.80038837248933],[-1.2774198134003358,49.89866971347594],[-0.6385681191367371,49.957638518067895],[0,50],[0,33],[0,25],[0,17],[0,10],[0,6],[0,3],[0,0],[-10,0],[-9.941845916850381,1.0921557795270211],[-9.861989455067432,2.0946254575904106],[-9.72224064694727,3.057782599259157],]);
}


